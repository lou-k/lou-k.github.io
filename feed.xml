<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.7.4">Jekyll</generator><link href="https://lou.dev/feed.xml" rel="self" type="application/atom+xml" /><link href="https://lou.dev/" rel="alternate" type="text/html" /><updated>2020-07-07T08:06:52-04:00</updated><id>https://lou.dev/</id><title type="html">Lou Kratz</title><subtitle>Lou Kratz is a research engineer who specializes in computer vision and machine learning.
</subtitle><entry><title type="html">Compressing Recorded Lectures with CRF and ffmpeg</title><link href="https://lou.dev/blog/2020/class-ffmpeg/" rel="alternate" type="text/html" title="Compressing Recorded Lectures with CRF and ffmpeg" /><published>2020-07-06T00:00:00-04:00</published><updated>2020-07-06T00:00:00-04:00</updated><id>https://lou.dev/blog/2020/class-ffmpeg</id><content type="html" xml:base="https://lou.dev/blog/2020/class-ffmpeg/">&lt;p&gt;Last spring I was teaching Introduction to Computer Vision at Drexel when COVID-19 hit and, well, everyone had to adjust quickly. While my course always had an online section, I decided to make all of my lectures asynchronous in to provide maximum flexibility to students (and myself).&lt;/p&gt;

&lt;p&gt;After some prep, I booted up quicktime on my mac and screen-recorded my first lecture at 1080p. Even though quicktime encoded using H.264, the file size was &lt;em&gt;massive&lt;/em&gt;: nearly 5 GB for only an hour lecture.&lt;/p&gt;

&lt;p&gt;No problem, I figured, probably just a high bit rate and lack of b-frames. I re-encoded it using two-pass x264 but found the result was still hundreds of megabytes.&lt;/p&gt;

&lt;p&gt;You might be wondering why this is a problem. Most videos are hundreds of megabytes, right? Well, I had two issues here:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;I needed to ensure all of my students could watch the videos, and knew many of them may be in locations with poor internet access.&lt;/li&gt;
  &lt;li&gt;A lecture was &lt;em&gt;only&lt;/em&gt; my slides. I average about 1 per minute, so surely I only needed 60 frames of video which should be very, very small.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;After some googling around, I found x264 had exactly a feature for such videos: &lt;a href=&quot;https://trac.ffmpeg.org/wiki/Encode/H.264&quot;&gt;Constant Rate Factor&lt;/a&gt; (CRF) encoding.  With CRF you instruct the encoder to target a provided quality level throughout the encoding. This is great for low-motion videos like lecture slides. Since there is very little movement the CRF encoder can keep a very low bitrate and result in an extremely small file size. I have the occasional video or animation in my slides and CRF simply increases the bitrates at those times.&lt;/p&gt;

&lt;p&gt;On top of that, I implemented a few more tricks such as:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Telling x264 to optimize still images&lt;/li&gt;
  &lt;li&gt;Reducing the frame rate to 10fps&lt;/li&gt;
  &lt;li&gt;Adding fast start flags to the output file to make streaming easier and ensure compatibility with different devices.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;My final ffmpeg command is:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ffmpeg -i INPUT.mov -pix_fmt yuv420p -c:v libx264 -crf 18 -preset veryslow -tune stillimage -r 10 -acodec aac -b:v 48k -f mp4  -movflags +faststart OUTPUT.mp4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This resulting files average less than a MB per minute, most of which is audio, but have hardly any artifacts in the video.&lt;/p&gt;</content><author><name></name></author><summary type="html">Last spring I was teaching Introduction to Computer Vision at Drexel when COVID-19 hit and, well, everyone had to adjust quickly. While my course always had an online section, I decided to make all of my lectures asynchronous in to provide maximum flexibility to students (and myself).</summary></entry><entry><title type="html">AI All Around How Curalate Accelerates Your Workflow</title><link href="https://lou.dev/blog/2018/ai-curalate/" rel="alternate" type="text/html" title="AI All Around How Curalate Accelerates Your Workflow" /><published>2018-10-09T00:00:00-04:00</published><updated>2018-10-09T00:00:00-04:00</updated><id>https://lou.dev/blog/2018/ai-curalate</id><content type="html" xml:base="https://lou.dev/blog/2018/ai-curalate/"></content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Uploading EC2 Logs to S3 on Shutdown</title><link href="https://lou.dev/blog/2018/e2-logs/" rel="alternate" type="text/html" title="Uploading EC2 Logs to S3 on Shutdown" /><published>2018-09-04T00:00:00-04:00</published><updated>2018-09-04T00:00:00-04:00</updated><id>https://lou.dev/blog/2018/e2-logs</id><content type="html" xml:base="https://lou.dev/blog/2018/e2-logs/"></content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">How Curalate uses MXNet on AWS for Deep Learning Magic</title><link href="https://lou.dev/blog/2018/mxnet/" rel="alternate" type="text/html" title="How Curalate uses MXNet on AWS for Deep Learning Magic" /><published>2018-07-27T00:00:00-04:00</published><updated>2018-07-27T00:00:00-04:00</updated><id>https://lou.dev/blog/2018/mxnet</id><content type="html" xml:base="https://lou.dev/blog/2018/mxnet/"></content><author><name></name></author><category term="computer" /><category term="vision" /><category term="deep" /><category term="machine" /><category term="learning" /><category term="curalate" /><category term="mxnet" /><category term="agile" /><summary type="html"></summary></entry><entry><title type="html">R&amp;amp;D At Curalate: A Case Study of Deep Metric Embedding</title><link href="https://lou.dev/blog/2018/deep-metric-embedding/" rel="alternate" type="text/html" title="R&amp;D At Curalate: A Case Study of Deep Metric Embedding" /><published>2018-02-01T05:11:36-05:00</published><updated>2018-02-01T05:11:36-05:00</updated><id>https://lou.dev/blog/2018/deep-metric-embedding</id><content type="html" xml:base="https://lou.dev/blog/2018/deep-metric-embedding/"></content><author><name></name></author><category term="computer" /><category term="vision" /><category term="deep" /><category term="metric" /><category term="machine" /><category term="learning" /><summary type="html"></summary></entry><entry><title type="html">Content Based Intelligent Cropping</title><link href="https://lou.dev/blog/2017/content-based-intelligent-cropping/" rel="alternate" type="text/html" title="Content Based Intelligent Cropping" /><published>2017-04-13T01:11:36-04:00</published><updated>2017-04-13T01:11:36-04:00</updated><id>https://lou.dev/blog/2017/content-based-intelligent-cropping</id><content type="html" xml:base="https://lou.dev/blog/2017/content-based-intelligent-cropping/"></content><author><name></name></author><category term="python" /><category term="notebook" /><category term="vision" /><category term="intelligent" /><category term="cropping" /><category term="smart" /><category term="product" /><category term="face" /><summary type="html"></summary></entry><entry><title type="html">Brewing EmojiNet</title><link href="https://lou.dev/blog/2016/emojinet/" rel="alternate" type="text/html" title="Brewing EmojiNet" /><published>2016-01-20T10:11:36-05:00</published><updated>2016-01-20T10:11:36-05:00</updated><id>https://lou.dev/blog/2016/emojinet</id><content type="html" xml:base="https://lou.dev/blog/2016/emojinet/"></content><author><name></name></author><category term="deep" /><category term="learning" /><category term="vision" /><category term="emoji" /><category term="convolutional" /><category term="neural" /><category term="network" /><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://lou.dev/assets/2016-01-13-Emojinet/demo02.png" /></entry><entry><title type="html">Meet the Emojini 3000 – The Internet’s Premier Emoji Granting Genie</title><link href="https://lou.dev/blog/2015/emojini/" rel="alternate" type="text/html" title="Meet the Emojini 3000 – The Internet’s Premier Emoji Granting Genie" /><published>2015-12-17T00:00:00-05:00</published><updated>2015-12-17T00:00:00-05:00</updated><id>https://lou.dev/blog/2015/emojini</id><content type="html" xml:base="https://lou.dev/blog/2015/emojini/"></content><author><name></name></author><category term="emoji" /><category term="deep" /><category term="learning" /><category term="instagram" /><summary type="html"></summary></entry><entry><title type="html">How Curalate Built a Kick-Ass Research &amp;amp; Development Team</title><link href="https://lou.dev/blog/2015/kickass-randd/" rel="alternate" type="text/html" title="How Curalate Built a Kick-Ass Research &amp; Development Team" /><published>2015-12-17T00:00:00-05:00</published><updated>2015-12-17T00:00:00-05:00</updated><id>https://lou.dev/blog/2015/kickass-randd</id><content type="html" xml:base="https://lou.dev/blog/2015/kickass-randd/"></content><author><name></name></author><category term="r&amp;d" /><category term="curalate" /><category term="research" /><category term="and" /><category term="development" /><category term="team" /><category term="building" /><summary type="html"></summary></entry></feed>